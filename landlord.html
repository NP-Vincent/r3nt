<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>r3nt — Create Listing</title>

  <!-- Farcaster Mini App embed -->
  <meta name="fc:miniapp" content='{
    "version":"1",
    "imageUrl":"https://r3nt.sqmu.net/assets/icon.png",
    "button":{
      "title":"Open r3nt",
      "action":{
        "type":"launch_miniapp",
        "name":"r3nt",
        "url":"https://r3nt.sqmu.net/index.html",
        "splashImageUrl":"https://r3nt.sqmu.net/assets/splashscreen.png",
        "splashBackgroundColor":"#FFFFFF"
      }
    }
  }' />

  <link rel="stylesheet" href="./styles/theme.css" />

  <script src="./js/dev-settings.js"></script>
  <script src="./js/dev-error-console.js"></script>
</head>
<body class="page-compact">
  <header>
    <div class="brand">r3nt by SQMU</div>
  </header>

  <div class="muted beta-note">early beta.</div>

  <nav>
    <button type="button" class="back-button" data-back-button hidden aria-label="Go back">
      <span aria-hidden="true">←</span>
      Back
    </button>
    <a href="./index.html">Home</a>
    <a href="./tenant.html">Tenant</a>
    <a href="./landlord.html">Landlord</a>
    <a href="./investor.html">Investor</a>
    <a href="./agent.html">Agent</a>
    <span class="version-badge" data-version></span>
  </nav>
  <div id="notificationTray" class="notification-tray"></div>
  <h1>r3nt — Create Listing</h1>

  <section class="card">
    <h2>Wallet &amp; platform setup</h2>
    <p class="muted">Connect your wallet to load the latest platform fees and unlock listing tools.</p>
    <div id="contextBar" class="muted">Starting…</div>
    <div id="feeInfo" class="muted">Listing price: — USDC</div>
    <button id="connect" disabled>Connect Wallet</button>
    <div id="status" class="muted"></div>
  </section>

  <!-- Removed manual Cast URL/Hash field. We will compose and capture the hash automatically. -->

  <section class="card" data-collapsible>
    <button type="button" class="inline-button collapsible-toggle" data-collapsible-toggle>
      Configure new listing
    </button>
    <div data-collapsible-content>
      <p class="muted">Follow the guided sections to publish a new property. Each step helps us generate on-chain metadata and your Farcaster cast.</p>
      <div class="guided-section">
        <h3>1. Property basics</h3>
        <p class="section-subtext">We use these details to generate your Farcaster cast and metadata.</p>
        <div class="field-grid columns-2">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Latitude</span>
              <span class="field-hint">Decimal degrees, e.g. 25.2048</span>
              <input id="lat" placeholder="25.2048" inputmode="decimal">
            </div>
          </label>
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Longitude</span>
              <span class="field-hint">Decimal degrees, e.g. 55.2708</span>
              <div class="field-inline">
                <input id="lon" placeholder="55.2708" inputmode="decimal">
                <button type="button" id="useLocation" class="inline-button location-detect">Use my current location</button>
              </div>
            </div>
          </label>
        </div>
        <div class="muted location-tip" id="locationTip"><small>Need coordinates? <a href="https://support.google.com/maps/answer/18539" target="_blank" rel="noopener">Right-click → “What’s here?” in Google Maps</a>.</small></div>
        <div class="field-grid">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Title (max 64 chars)</span>
              <span class="field-hint">Appears as the property headline inside your cast.</span>
              <input id="title" maxlength="64" placeholder="Cozy studio near metro">
            </div>
          </label>

          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Short description (max 140 chars)</span>
              <span class="field-hint">Short summary shown on previews and share cards.</span>
              <input id="shortDesc" maxlength="140" placeholder="Furnished, walk to metro, fast Wi‑Fi">
            </div>
          </label>
        </div>
      </div>

      <div class="guided-section">
        <h3>2. Pricing &amp; size</h3>
        <p class="section-subtext">Share the deposit, footprint and daily rate you want to accept.</p>
        <div class="field-grid columns-2">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Deposit (USDC)</span>
              <span class="field-hint">Escrowed upfront and released after platform approval.</span>
              <input id="deposit" placeholder="100.00" inputmode="decimal">
            </div>
          </label>
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Property size (m²)</span>
              <span class="field-hint">Square metre footprint used when tokenising bookings.</span>
              <input id="areaSqm" placeholder="85" inputmode="numeric">
            </div>
          </label>
        </div>
        <div class="field-grid">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Daily (USDC)</span>
              <span class="field-hint">Required — sets the on-chain price per day.</span>
              <input id="rateDaily" value="0" inputmode="decimal">
            </div>
          </label>
        </div>
      </div>

      <div class="guided-section">
        <h3>3. Booking policies</h3>
        <p class="section-subtext">Control how soon tenants can book and how far in advance your calendar opens.</p>
        <div class="field-grid columns-2">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Min booking notice (hours)</span>
              <span class="field-hint">Minimum time before check-in that bookings are allowed.</span>
              <input id="minNotice" value="24" inputmode="numeric">
            </div>
          </label>
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Booking window (days, 0 = none)</span>
              <span class="field-hint">How far into the future tenants can reserve.</span>
              <input id="maxWindow" value="90" inputmode="numeric">
            </div>
          </label>
        </div>
        <div class="muted"><small>Adjust how soon and how far ahead tenants can reserve.</small></div>
      </div>

      <div class="guided-section">
        <h3>4. Metadata (optional)</h3>
        <p class="section-subtext">Leave blank and we’ll generate a JSON payload with your inputs.</p>
        <div class="field-grid">
          <label class="field-option">
            <span class="status-dot" aria-hidden="true"></span>
            <div class="field-content">
              <span class="field-title">Metadata URL (optional)</span>
              <span class="field-hint">Provide hosted JSON if you manage metadata externally. Leave blank and we’ll auto-generate it.</span>
              <input id="metadataUrl" placeholder="https://example.com/listing.json">
            </div>
          </label>
        </div>
      </div>

      <div class="muted" style="margin-top:16px;"><small class="mono">Listings deploy via the Platform contract. Your wallet address becomes the landlord.</small></div>
      <button id="create" disabled>Create Listing</button>
    </div>
  </section>

  <section class="card" data-collapsible>
    <button type="button" class="inline-button collapsible-toggle" data-collapsible-toggle>
      Manage existing listings
    </button>
    <div data-collapsible-content>
      <p class="muted">Access live availability tools and filters for every property linked to your wallet.</p>
      <div id="listingControls" class="listing-controls" hidden>
        <label>
          <span>Sort by</span>
          <select id="listingSort">
            <option value="created-desc">Newest → Oldest</option>
            <option value="created-asc">Oldest → Newest</option>
            <option value="price-asc">Base price: Low → High</option>
            <option value="price-desc">Base price: High → Low</option>
          </select>
        </label>
        <label>
          <span>Location filter</span>
          <input id="listingLocationFilter" placeholder="Latitude,Longitude" autocomplete="off" spellcheck="false" />
        </label>
        <button type="button" id="listingLocationClear" class="inline-button">Clear</button>
      </div>
      <div id="landlordListings" class="muted">Connect wallet to load your listings.</div>
    </div>
  </section>

  <footer>
    r3nt by SQMU. USDC. Arbitrum.
  </footer>

  <script type="module" src="./js/landlord.js"></script>
</body>
</html>

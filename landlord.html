<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>r3nt — Create Listing</title>

  <!-- Farcaster Mini App embed -->
  <meta name="fc:miniapp" content='{
    "version":"1",
    "imageUrl":"https://r3nt.sqmu.net/assets/icon.png",
    "button":{
      "title":"Open r3nt",
      "action":{
        "type":"launch_miniapp",
        "name":"r3nt",
        "url":"https://r3nt.sqmu.net/index.html",
        "splashImageUrl":"https://r3nt.sqmu.net/assets/splashscreen.png",
        "splashBackgroundColor":"#FFFFFF"
      }
    }
  }' />

  <style>
    :root { --fg:#0f172a; --bg:#ffffff; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif; max-width: 460px; margin: 0 auto; padding: 16px 16px 40px; background: var(--bg); color: var(--fg); }
    h1 { font-size: 1.25rem; margin: 8px 0 12px; }
    .row { display: flex; gap: 10px; }
    label { display: block; font-size: .9rem; margin: 10px 0 6px; }
    input { width: 100%; padding: 10px 12px; border: 1px solid #d0d7de; border-radius: 8px; font-size: .95rem; }
    small.mono { font-family: ui-monospace, Menlo, monospace; color:#666; }
    button { width: 100%; padding: 12px 16px; border: 0; border-radius: 10px; font-weight: 700; cursor: pointer; }
    button:disabled { opacity: .6; cursor: not-allowed; }
    #connect { background: #1f6feb; color: #fff; margin: 8px 0; }
    #create  { background: #10b981; color: #fff; margin: 8px 0; }
    .pill { display:inline-block; padding:2px 8px; background:#eef2ff; color:#3730a3; border-radius:999px; font-size:.8rem; }
    #status { min-height: 22px; margin-top: 10px; font-size: .95rem; color:#444; }
    .muted { color:#666; }
    .divider { height:1px; background:#eee; margin:14px 0; }
    nav { margin-bottom:16px; }
    nav a { margin-right:10px; color:#1f6feb; text-decoration:none; font-weight:600; }
    .version-badge { display:inline-block; margin-left:8px; padding:2px 6px; border-radius:8px; font-size:.65rem; letter-spacing:.08em; text-transform:uppercase; background:#e2e8f0; color:#475569; }
    #landlordListings { margin-top:12px; display:flex; flex-direction:column; gap:12px; }
    .landlord-card { border:1px solid #e5e7eb; border-radius:12px; padding:12px; }
    .landlord-card-title { font-weight:600; margin-bottom:6px; }
    .landlord-card-detail { font-size:.9rem; margin:2px 0; }
    #landlordListings .row { margin-top:8px; }
    #landlordListings .row label { flex:1; }
    button.check-availability { background:#64748b; color:#fff; margin-top:8px; }
    .availability-result { margin-top:6px; font-size:.9rem; color:#444; }
    .availability-result.available { color:#047857; }
    .availability-result.unavailable,
    .availability-result.error { color:#dc2626; }
    a.listing-link { display:inline-block; margin-top:8px; color:#1f6feb; font-weight:600; text-decoration:none; }
    a.listing-link:hover { text-decoration:underline; }
  </style>
  <script src="./js/dev-error-console.js"></script>
</head>
<body>
  <nav>
    <a href="./index.html">Home</a>
    <a href="./tenant.html">Tenant</a>
    <a href="./landlord.html">Landlord</a>
    <a href="./admin.html">Admin</a>
    <span class="version-badge" data-version></span>
  </nav>
  <h1>r3nt — Create Listing</h1>

  <div id="contextBar" class="muted">Starting…</div>
  <div id="feeInfo" class="muted">Listing price: — USDC</div>

  <button id="connect" disabled>Connect Wallet</button>

  <!-- Removed manual Cast URL/Hash field. We will compose and capture the hash automatically. -->

  <div class="row">
    <label>Latitude
      <input id="lat" placeholder="25.2048" inputmode="decimal">
    </label>
    <label>Longitude
      <input id="lon" placeholder="55.2708" inputmode="decimal">
    </label>
  </div>
  <div class="muted"><small>We derive a GeoHash locally from these coordinates.</small></div>

  <label>Title (max 64 chars)
    <input id="title" maxlength="64" placeholder="Cozy studio near metro">
  </label>

  <label>Short description (max 140 chars)
    <input id="shortDesc" maxlength="140" placeholder="Furnished, walk to metro, fast Wi‑Fi">
  </label>

  <div class="divider"></div>

  <div class="row">
    <label>Deposit (USDC)
      <input id="deposit" placeholder="100.00" inputmode="decimal">
    </label>
    <label>Property size (m²)
      <input id="areaSqm" placeholder="85" inputmode="numeric">
    </label>
  </div>

  <div class="row">
    <label>Min booking notice (hours)
      <input id="minNotice" value="24" inputmode="numeric">
    </label>
    <label>Booking window (days, 0 = none)
      <input id="maxWindow" value="90" inputmode="numeric">
    </label>
  </div>
  <div class="muted"><small>Adjust how soon and how far ahead tenants can reserve.</small></div>

  <div class="row">
    <label>Daily (USDC)
      <input id="rateDaily"  value="0" inputmode="decimal">
    </label>
    <label>Weekly (USDC)
      <input id="rateWeekly" value="0" inputmode="decimal">
    </label>
    <label>Monthly (USDC)
      <input id="rateMonthly" value="0" inputmode="decimal">
    </label>
  </div>

  <label>Metadata URL (optional)
    <input id="metadataUrl" placeholder="https://example.com/listing.json">
  </label>
  <div class="muted"><small>Leave blank to auto-generate an inline JSON metadata payload.</small></div>

  <div class="divider"></div>

  <div class="muted"><small class="mono">Listings deploy via the Platform contract. Your wallet address becomes the landlord.</small></div>

  <button id="create" disabled>Create Listing</button>
  <div id="status"></div>

  <div class="divider"></div>
  <h2>Your Listings</h2>
  <div class="muted"><small>Check availability for each listing below.</small></div>
  <div id="landlordListings" class="muted">Connect wallet to load your listings.</div>

  <script type="module" src="./js/landlord.js"></script>
</body>
</html>
